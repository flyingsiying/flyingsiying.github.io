<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <title>Agent-based Spatial Pattern Modeling Using NetLogo Part 2</title>
  <meta name="description" content="I developed this model to simulate simple random motion and biased random motion within constrained space. The major difference with the previous model is that this model loads pre-created GIS data to generate NetLogo data.

">
  <meta name="author" content="Siying Chen">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Agent-based Spatial Pattern Modeling Using NetLogo Part 2">
  <meta name="twitter:description" content="I developed this model to simulate simple random motion and biased random motion within constrained space. The major difference with the previous model is that this model loads pre-created GIS data to generate NetLogo data.

">
  
  <meta name="twitter:image" content="/images/favicons/favicon-194x194.png" />

  <meta property="og:type" content="article">
  <meta property="og:title" content="Agent-based Spatial Pattern Modeling Using NetLogo Part 2">
  <meta property="og:description" content="I developed this model to simulate simple random motion and biased random motion within constrained space. The major difference with the previous model is that this model loads pre-created GIS data to generate NetLogo data.

">
  <meta property="og:image" content="/images/favicons/favicon-194x194.png" />

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <link rel="stylesheet" href="/css/main.css?1509929049967058000">
  <link rel="canonical" href="http://localhost:4000/2016/netlogo2/">
  <link rel="alternate" type="application/rss+xml" title="Siying Chen" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Siying Chen">
          <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Siying Chen</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">GIS, sustainable transportation, and more livable cities please.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Siying Chen blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

            

            

            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/flyingsiying" title="flyingsiying on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:flyingsiying@gmail.com" title="Email flyingsiying@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="22 Feb 2016" class="post-meta__date date">22 Feb 2016</time>
      
      &#8226; <span class="post-meta__tags">on <a href="/tags/#GIS">GIS</a> </span>
      
    </div>
    <h1 class="post-title">Agent-based Spatial Pattern Modeling Using NetLogo Part 2</h1>
  </header>

  <section class="post">
    <p>I developed this model to simulate simple random motion and biased random motion within constrained space. The major difference with the <a href="https://flyingsiying.github.io/blog/2016/netlogo1/">previous model</a> is that this model loads pre-created GIS data to generate NetLogo data.</p>

<p>How this model works:</p>
<ul>
  <li>This program loads the GIS data of the Ohio State University buildings and pavement from
shapefiles.</li>
  <li>It generates NetLogo data and picks a random building as a <code class="highlighter-rouge">target</code> for student movement.</li>
  <li>It generates up to 200 students at random buildings.</li>
  <li>It allows students to move only within buildings (green patches) and orange patches (pavement).</li>
  <li>User can define whether student motion is random or biased towards the target building. <code class="highlighter-rouge">random-motion</code> involves a simple heuristic - test whether the patch in front of the student is feasible (green or orange); if so, move forward to that patch. If not, a student makes a random left turn. With <code class="highlighter-rouge">biased-motion</code>, a student turns to face the target after a successful move forward.</li>
  <li><code class="highlighter-rouge">test-arrival</code> tests if a student is within 5 units of the target. If so, the student moves to that target, is removed, and the arrival-count is incremented.</li>
</ul>

<p>Demo:
<img src="https://raw.githubusercontent.com/flyingsiying/blog/gh-pages/images/demo/osu.gif" alt="" /></p>

<p>To set up, the model loads the GIS data and sets the envelope for the NetLogo world.</p>
<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">extensions</span> <span class="p">[</span> <span class="n">gis</span> <span class="p">]</span>
<span class="n">globals</span> <span class="p">[</span> <span class="n">pavement</span> <span class="n">building</span> <span class="n">centroid</span> <span class="n">arrival</span><span class="o">-</span><span class="n">count</span> <span class="n">target</span><span class="p">]</span>
<span class="n">breed</span> <span class="p">[</span><span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="n">building</span><span class="o">-</span><span class="n">label</span><span class="p">]</span>
<span class="n">breed</span> <span class="p">[</span><span class="n">target</span><span class="o">-</span><span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="n">target</span><span class="o">-</span><span class="n">building</span><span class="o">-</span><span class="n">label</span><span class="p">]</span> <span class="p">;</span> <span class="n">this</span> <span class="n">breed</span> <span class="n">is</span> <span class="n">not</span> <span class="n">necessarily</span> <span class="n">used</span> <span class="k">in</span> <span class="n">my</span> <span class="n">code</span>
<span class="n">breed</span> <span class="p">[</span><span class="n">students</span> <span class="n">student</span><span class="p">]</span>

<span class="n">to</span> <span class="n">set</span><span class="o">-</span><span class="n">up</span>
  <span class="n">ca</span>
  <span class="n">set</span> <span class="n">pavement</span> <span class="n">gis</span><span class="ss">:load</span><span class="o">-</span><span class="n">dataset</span> <span class="s2">"OSU_data/pavement.shp"</span>
  <span class="n">set</span> <span class="n">building</span> <span class="n">gis</span><span class="ss">:load</span><span class="o">-</span><span class="n">dataset</span> <span class="s2">"OSU_data/buildings.shp"</span>
  <span class="n">gis</span><span class="ss">:set</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">envelope</span> <span class="p">(</span><span class="n">gis</span><span class="ss">:envelope</span><span class="o">-</span><span class="n">union</span><span class="o">-</span><span class="n">of</span>
    <span class="p">(</span><span class="n">gis</span><span class="ss">:envelope</span><span class="o">-</span><span class="n">of</span> <span class="n">pavement</span><span class="p">)</span>
    <span class="p">(</span><span class="n">gis</span><span class="ss">:envelope</span><span class="o">-</span><span class="n">of</span> <span class="n">building</span><span class="p">)</span> <span class="p">)</span>
  <span class="n">set</span> <span class="n">arrival</span><span class="o">-</span><span class="n">count</span> <span class="mi">0</span>  <span class="p">;</span> <span class="n">reset</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">arrived</span> <span class="n">students</span>
  <span class="n">reset</span><span class="o">-</span><span class="n">ticks</span>
<span class="k">end</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">hide-labels</code> and <code class="highlighter-rouge">show-labels</code> ask the building-labels to show themselves.</p>
<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">to</span> <span class="nb">display</span><span class="o">-</span><span class="n">buildings</span>
  <span class="n">ask</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="p">[</span><span class="n">die</span><span class="p">]</span>
  <span class="n">gis</span><span class="ss">:set</span><span class="o">-</span><span class="n">drawing</span><span class="o">-</span><span class="n">color</span> <span class="n">green</span>
  <span class="n">gis</span><span class="ss">:draw</span> <span class="n">building</span> <span class="mi">3</span>
    <span class="n">foreach</span> <span class="n">gis</span><span class="ss">:feature</span><span class="o">-</span><span class="n">list</span><span class="o">-</span><span class="n">of</span> <span class="n">building</span>
    <span class="p">[</span> <span class="n">set</span> <span class="n">centroid</span> <span class="n">gis</span><span class="ss">:location</span><span class="o">-</span><span class="n">of</span> <span class="n">gis</span><span class="ss">:centroid</span><span class="o">-</span><span class="n">of</span> <span class="p">?</span>
      <span class="k">if</span> <span class="n">not</span> <span class="n">empty?</span> <span class="n">centroid</span>
      <span class="p">[</span> <span class="n">create</span><span class="o">-</span><span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="mi">1</span>
          <span class="p">[</span> <span class="n">set</span> <span class="n">xcor</span> <span class="n">item</span> <span class="mi">0</span> <span class="n">centroid</span>
            <span class="n">set</span> <span class="n">ycor</span> <span class="n">item</span> <span class="mi">1</span> <span class="n">centroid</span>
            <span class="n">set</span> <span class="n">size</span> <span class="mi">0</span>
            <span class="n">set</span> <span class="n">label</span> <span class="n">gis</span><span class="ss">:property</span><span class="o">-</span><span class="n">value</span> <span class="p">?</span> <span class="s2">"BLDG_NAME"</span> <span class="p">]</span> <span class="p">]</span> <span class="p">]</span>
<span class="k">end</span>


<span class="n">to</span> <span class="nb">display</span><span class="o">-</span><span class="n">pavement</span>
  <span class="n">gis</span><span class="ss">:set</span><span class="o">-</span><span class="n">drawing</span><span class="o">-</span><span class="n">color</span> <span class="n">red</span>
  <span class="n">gis</span><span class="ss">:draw</span> <span class="n">pavement</span> <span class="mi">1</span>
<span class="k">end</span>


<span class="n">to</span> <span class="n">hide</span><span class="o">-</span><span class="n">labels</span>
  <span class="n">ask</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="p">[</span><span class="n">hide</span><span class="o">-</span><span class="n">turtle</span><span class="p">]</span>
<span class="k">end</span>


<span class="n">to</span> <span class="n">show</span><span class="o">-</span><span class="n">labels</span>
  <span class="n">ask</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="p">[</span><span class="n">show</span><span class="o">-</span><span class="n">turtle</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">create-buildings</code> generates green patches based on the building shapefile. <code class="highlighter-rouge">create-paths</code> generates orange patches based on the pavement shapefile. A random building (building-label) is designated as the target.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">to</span> <span class="n">create</span><span class="o">-</span><span class="no">NetLogo</span><span class="o">-</span><span class="n">data</span>
  <span class="n">create</span><span class="o">-</span><span class="n">buildings</span>
  <span class="n">create</span><span class="o">-</span><span class="n">paths</span>
<span class="k">end</span>


<span class="n">to</span> <span class="n">create</span><span class="o">-</span><span class="n">buildings</span>
  <span class="k">if</span> <span class="n">not</span> <span class="n">any?</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="p">[</span><span class="nb">display</span><span class="o">-</span><span class="n">buildings</span><span class="p">]</span>
  <span class="n">ask</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span> <span class="p">[</span><span class="n">hide</span><span class="o">-</span><span class="n">turtle</span><span class="p">]</span>
  <span class="n">ask</span> <span class="n">patches</span> <span class="n">gis</span><span class="ss">:intersecting</span> <span class="n">building</span>
  <span class="p">[</span><span class="n">set</span> <span class="n">pcolor</span> <span class="n">green</span><span class="p">]</span>
  <span class="n">set</span> <span class="n">target</span> <span class="n">one</span><span class="o">-</span><span class="n">of</span> <span class="n">building</span><span class="o">-</span><span class="n">labels</span>
  <span class="n">ask</span> <span class="n">target</span> <span class="p">[</span><span class="n">show</span><span class="o">-</span><span class="n">turtle</span><span class="p">]</span>

<span class="k">end</span>


<span class="n">to</span> <span class="n">create</span><span class="o">-</span><span class="n">paths</span>
  <span class="n">ask</span> <span class="n">patches</span> <span class="n">gis</span><span class="ss">:intersecting</span> <span class="n">pavement</span>
  <span class="p">[</span> <span class="n">set</span> <span class="n">pcolor</span> <span class="n">orange</span> <span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The model uses the input of <code class="highlighter-rouge">number-student</code> to create students at random green patches (buildings).</p>
<pre><code class="language-ruby``">to generate-students
  ask n-of number-students patches with [pcolor = green]
  [ sprout-students 1 [
      set color white
      set shape "person student"
      set size 15 ]
  ]
end
</code></pre>

<p><code class="highlighter-rouge">remove-students</code> asks students to die and resets the <code class="highlighter-rouge">arrvial-count</code>, the number of students who have arrived at the target.</p>
<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">to</span> <span class="n">remove</span><span class="o">-</span><span class="n">students</span>
  <span class="n">ask</span> <span class="n">students</span> <span class="p">[</span><span class="n">die</span><span class="p">]</span>
  <span class="n">set</span> <span class="n">arrival</span><span class="o">-</span><span class="n">count</span> <span class="mi">0</span>
<span class="k">end</span>
</code></pre>
</div>

<p>To initiate student movement, if <code class="highlighter-rouge">biased-motion</code> is switched on, students turn to face the target. Otherwise, they make a random left turn. Students can only move forward if the patch in front of them is feasible (either green or orange). If they move to the edge of the NetLogo world, they make a random left turn.</p>
<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">to</span> <span class="n">move</span><span class="o">-</span><span class="n">students</span>
  <span class="k">if</span> <span class="n">not</span> <span class="n">any?</span> <span class="n">students</span> <span class="p">[</span> <span class="n">stop</span> <span class="p">]</span>
  <span class="n">ask</span> <span class="n">students</span> <span class="p">[</span>
     <span class="n">random</span><span class="o">-</span><span class="n">motion</span> <span class="p">;</span> <span class="n">random</span> <span class="n">motion</span> <span class="n">of</span> <span class="n">students</span>
     <span class="nb">test</span><span class="o">-</span><span class="n">arrival</span> <span class="p">;</span> <span class="nb">test</span> <span class="k">if</span> <span class="n">the</span> <span class="n">student</span> <span class="n">has</span> <span class="n">arrived</span> <span class="n">at</span> <span class="n">the</span> <span class="n">target</span>
   <span class="p">]</span>
  <span class="n">tick</span>
<span class="k">end</span>


<span class="n">to</span> <span class="n">random</span><span class="o">-</span><span class="n">motion</span>
  <span class="n">ifelse</span> <span class="n">patch</span><span class="o">-</span><span class="n">ahead</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">nobody</span> <span class="p">[</span>  
    <span class="n">ifelse</span> <span class="p">[</span><span class="n">pcolor</span><span class="p">]</span> <span class="n">of</span> <span class="n">patch</span><span class="o">-</span><span class="n">ahead</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">green</span> <span class="n">or</span> <span class="p">[</span><span class="n">pcolor</span><span class="p">]</span> <span class="n">of</span> <span class="n">patch</span><span class="o">-</span><span class="n">ahead</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">orange</span>
    <span class="p">[</span> <span class="n">fd</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">the</span> <span class="n">student</span> <span class="n">moves</span> <span class="n">forward</span> <span class="n">to</span> <span class="n">that</span> <span class="n">patch</span>
      <span class="k">if</span> <span class="n">biased</span><span class="o">-</span><span class="n">motion</span> <span class="p">[</span> <span class="n">face</span> <span class="n">target</span><span class="p">]</span>   <span class="p">]</span>   
    <span class="p">[</span> <span class="n">lt</span> <span class="n">random</span><span class="o">-</span><span class="n">float</span> <span class="mi">360</span> <span class="p">]</span>
    <span class="p">]</span>
  <span class="p">[</span> <span class="n">lt</span> <span class="n">random</span><span class="o">-</span><span class="n">float</span> <span class="mi">360</span> <span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">test-arrival</code> tests if a student is within five units of the target. Five patches is necessary since a building centroid may be in an interior courtyard and not part of the building. The optimal distance could be more or less. Arrived students will disappear from the NetLogo world.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">to</span> <span class="nb">test</span><span class="o">-</span><span class="n">arrival</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="n">target</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span>  <span class="p">[</span>
    <span class="n">move</span><span class="o">-</span><span class="n">to</span> <span class="n">target</span>
    <span class="n">set</span> <span class="n">arrival</span><span class="o">-</span><span class="n">count</span> <span class="n">arrival</span><span class="o">-</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">die</span> <span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

  </section>
  
</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2017 Siying Chen. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1509929049967058000"></script>


    </div>
  </body>
</html>